<html>
<head>
<title>Wizard Internet Settings</title>
<link rel="stylesheet" href="/style/normal_ws.css" type="text/css">
<LINK REL="stylesheet" HREF="/style/handaer.css" TYPE="text/css" media="all">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<script language="JavaScript" type="text/javascript" src="/lang/b28n.js"></script>
<script language="JavaScript" type="text/javascript">
var step_num;
function style_display_on(){if (window.ActiveXObject){return "inline-block";}else if (window.XMLHttpRequest){return "table-row";}}
function widget_hide(widgetID){document.getElementById(widgetID).style.visibility = "hidden";document.getElementById(widgetID).style.display = "none";}
function widget_display(widgetID){document.getElementById(widgetID).style.visibility = "visible";document.getElementById(widgetID).style.display = style_display_on();}

function widget_enable(widgetID){document.getElementById(widgetID).disabled = false;}
function widget_disable(widgetID){document.getElementById(widgetID).disabled = true;}

function trans_inner(widgetID,xmlname){var e = document.getElementById(widgetID);e.innerHTML = _(xmlname);}
function trans_value(widgetID,xmlname){var e = document.getElementById(widgetID);e.value = _(xmlname);}

function button_commit(buttonID){document.getElementById(buttonID).click();}

function showpwd(spanID,passName,passID,checkboxID)
{
    var pass = document.getElementById(passID).value;
	if(document.getElementById(checkboxID).checked == true)
	{
		document.getElementById(spanID).innerHTML='<input type="text" name='+passName+' id='+passID+' maxlength="32" size="32"  class="handaer_text_content" value="'+pass+'" />';
	}
	else
	{
		document.getElementById(spanID).innerHTML='<input type="password" name='+passName+' id='+passID+' maxlength="32" size="32"  class="handaer_text_content" value="'+pass+'" />';
	}
}
function initclickfun()
{
	document.getElementById("cccc").onclick = function(){showpwd("pwdinput","PSK_KEY","pwd","cccc");}; 
}
function butwork(zhi1,zhi2,zhi3,zhi4)
{
	if(zhi1 == "false")
		widget_display("bBACK");
	else
		widget_hide("bBACK");
	
	if(zhi2 == "false")
		widget_display("bNEXT");
	else
		widget_hide("bNEXT");	

	if(zhi3 == "false")
		widget_display("bCANCEL");
	else
		widget_hide("bCANCEL");	

	if(zhi4 == "false")
		widget_display("bAPPLY");
	else
		widget_hide("bAPPLY");	
}

function checkInjection(str)
{
	var len = str.length;
	for (var i=0; i<str.length; i++) {
		if ( str.charAt(i) == '\r' || str.charAt(i) == '\n'){
				return false;
		}else
	        continue;
	}
    return true;
}

function reloadd()
{
	window.location.reload();
}
function disableWirelessSettings()
{
	document.wizard_form.AP_SSID.disabled = false;
	switch_security_mode();
}
function switch_security_mode()
{
	widget_display("div_security_key");
	document.wizard_form.PSK_KEY.disabled = false;
	if (document.wizard_form.AP_SECMODE.selectedIndex != 0)
	{
		widget_hide("div_security_key");
		document.wizard_form.PSK_KEY.disabled = true;
	}
}
function CheckWirelessValue()
{
	if(document.wizard_form.WIFION_OFF[0].checked == true)
	{
		if (document.wizard_form.AP_SSID.value.length == 0)
		{
			alert(_("err SSID empty"));
			document.wizard_form.AP_SSID.select();
			return false;
		}
		if (document.wizard_form.AP_SSID.value.length > 24 )
		{
			alert(_("err SSID length"));
			document.wizard_form.AP_SSID.select();
			return false;
		}
		
		if (document.wizard_form.AP_SECMODE.selectedIndex == 0)
		{
			var keyvalue = document.wizard_form.PSK_KEY.value;
			if (keyvalue.length == 0)
			{
				alert(_("err key"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}
			if ((keyvalue.length < 8)||( keyvalue.length > 12))
			{
				alert(_("err keylen"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}

			{
				var xxx=keyvalue;  //用户名（在此赋值）

				var reg  = /^[a-z || A-Z || 0-9]\w+$/;
				var m = reg.test(xxx);
				if(m)   
				{   
				}   
				else   
				{   
					alert(_("err keychar"));
					document.wizard_form.PSK_KEY.select();
					return false;
				} 

			}
		}	
	}
	else
	{
		document.wizard_form.AP_PRIMARY_CH.disabled = true;
		document.wizard_form.AP_SECMODE.disabled = true;
		document.getElementById("pwd").disabled = true;	   
	}
	waitgifshow();
	button_commit("WIRELESS");
	return true;
}
function initTranslation()
{
	Butterlate.setTextDomain("wless");
	trans_inner("qsettitle","wless wifititle");
	trans_inner("wsetingst","wless wifititle");	
	Butterlate.setTextDomain("admin");	
	trans_inner("wifides","admw wifides");
	trans_inner("nname","admw nname");
	trans_inner("security","admw security");
	trans_inner("wkey","admw wkey");
	trans_inner("Sdisable","admin open");
	trans_inner("Senable","admin jiami");
	trans_inner("showp","admw showp");
	trans_value("bCANCEL","admw bCANCEL");
	trans_value("bAPPLY","admw bAPPLY");
	trans_inner("onbutton","admw onbutton");	
	trans_inner("offbutton","admw offbutton");
	trans_inner("ssidrequest","admw ssidrequest");
	trans_inner("passwordrequest","admw passwordrequest");
	trans_inner("wifiswitch","admw wifiswitch");	 
	trans_inner("settingwaiting","admw settingwaiting");	
	trans_inner("channelchoose","admw channelchoose");	
	trans_inner("hidewifides","admw hidewifides");	
}
function initclickfun()
{
	document.getElementById("cccc").onclick = function(){showpwd("pwdinput","PSK_KEY","pwd","cccc");}; 
}
function initValue()
{

	initTranslation();
	disableWirelessSettings();
	switch_wifi();
	inithidewifi();
	initclickfun();
}
function switch_wifi()
{
	if(document.wizard_form.WIFION_OFF[0].checked == true)
	{
		widget_display("div_security_key");
		widget_display("tt1");
		widget_display("channel");
		switch_security_mode();
	}
	else
	{
		widget_hide("div_security_key");
		widget_hide("tt1");
		widget_hide("channel");
	}
}
function waitgifshow()
{
	widget_hide("div_wireless");
	widget_hide("wifides");
	widget_hide("buttontable");
	widget_display("waitshow");
}
function inithidewifi()
{
	if(document.getElementById("AP_HIDESSID").value=="1")
		document.getElementById("hidewifi").checked = true;
	else
		document.getElementById("hidewifi").checked = false;
}
function hidewififun()
{
	if(document.getElementById("hidewifi").checked == true)
		document.getElementById("AP_HIDESSID").value="1";
	else
		document.getElementById("AP_HIDESSID").value="0";
}
</script>
</head>

<body onLoad="initValue()" ondragstart="window.event.returnValue=false" oncontextmenu="window.event.returnValue=false" onselectstart="event.returnValue=false">
<div class="handaer_main">
<table  width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<h1 id="qsettitle"></h1>
<p></p>

<FORM method="POST" name="wizard_form">
<!-- =========== Wireless Settings =========== -->
<h2 id="wifides"></h2>
<table id="div_wireless"  width="100%" cellpadding="0" cellspacing="0"   class="handaer_text">
<tr><td class="title" colspan="2" id="wsetingst"></td></tr>
<tr>
  <td class="head" id="nname"></td>
  <td><input type="text" name="AP_SSID" id="AP_SSID" size="32" maxlength="32" class="handaer_text_content"  value="~~AP_SSID~">&nbsp;<input type="checkbox" id="hidewifi" onclick="hidewififun();"/>&nbsp;<span id="hidewifides"></span>&nbsp;<span id="ssidrequest"></span></td>
</tr>

<tr>
 <td class="head" id="wifiswitch"></td>
	<td>&nbsp;<input type="radio"  ~cWIFION_OFF:on~ name="WIFION_OFF" value="on" onclick="switch_wifi();" checked /><span id="onbutton"></span>&nbsp;
	<input type="radio"  ~cWIFION_OFF:off~ name="WIFION_OFF" value="off" onclick="switch_wifi();"/><span id="offbutton"></span>
	</td>
</tr>

<tr id="channel">
  <td class="head" id="channelchoose"></td>
  <td>
    <select name="AP_PRIMARY_CH" size="1">
	  <!--option ~sAP_PRIMARY_CH:0~ value="0" id="channelauto"></option-->
	  <option ~sAP_PRIMARY_CH:1~ value="1">1</option>
      <option ~sAP_PRIMARY_CH:2~ value="2">2</option>
      <option ~sAP_PRIMARY_CH:3~ value="3">3</option>
      <option ~sAP_PRIMARY_CH:4~ value="4">4</option>
      <option ~sAP_PRIMARY_CH:5~ value="5">5</option>
      <option ~sAP_PRIMARY_CH:6~ value="6">6</option>
      <option ~sAP_PRIMARY_CH:7~ value="7">7</option>
      <option ~sAP_PRIMARY_CH:8~ value="8">8</option>
      <option ~sAP_PRIMARY_CH:9~ value="9">9</option>
      <option ~sAP_PRIMARY_CH:10~ value="10">10</option>
      <option ~sAP_PRIMARY_CH:11~ value="11">11</option>
      <option ~sAP_PRIMARY_CH:12~ value="12">12</option>
      <option ~sAP_PRIMARY_CH:13~ value="13">13</option>
    </select>
  </td>
</tr>

<tr  id="tt1">
  <td class="head" rowspan="2" id="security"></td>
  <td>
    <select name="AP_SECMODE" size="1" onChange="switch_security_mode();">
	  <option ~sAP_SECMODE:WPA~ value="WPA" id="Senable" ></option>
      <option ~sAP_SECMODE:None~  value="None" id="Sdisable"></option>
      <!--option value="WEPAUTO">WEP</option>
      <option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK</option-->
    </select>
  </td>
</tr>
<tr id="div_security_key">
  <td><span id="wkey"></span><span id="pwdinput"><input type="password" id="pwd" name="PSK_KEY" maxlength="64" size="28"  class="handaer_text_content"  value="~~PSK_KEY~"/></span>&nbsp;<input type="checkbox" id="cccc" />&nbsp;<span id="showp"></span>&nbsp;<span id="passwordrequest"></span></td>
							
</tr>
</table>
<div id="waitshow" style="display:none" align="center">
  <img align="center" src="/images/loading.gif"></img>
  <p align="center" id="settingwaiting"></p>
</div>

<table width="540" cellpadding="2" cellspacing="1" id="buttontable">
<tr align="center">
  <td>
    <input type="button" name="cancel_motion" id="bCANCEL" class="handaer_input" value="Cancel" onClick="window.location.reload();">
    <input type="button" name="apply_motion" id="bAPPLY" class="handaer_input" value="Apply" onClick="CheckWirelessValue();">
	<input type="submit" name="WIRELESS" id="WIRELESS" style="display:none" value="WIRELESS">
	<input type="text" style="display:none" name="AP_HIDESSID" id="AP_HIDESSID" size="20" maxlength="32" value="~~AP_HIDESSID~">
  </td>
</tr>
</table>
<!--/form-->
</td></tr></table> </div>
</body>
</html>

