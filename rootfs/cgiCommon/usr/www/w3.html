<html>
<head>
<title>Wizard Internet Settings</title>
<link rel="stylesheet" href="/style/normal_ws.css" type="text/css">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<script language="JavaScript" type="text/javascript" src="/lang/b28n.js"></script>
<script language="JavaScript" type="text/javascript">

var step_num;
function style_display_on()
{
	if (window.ActiveXObject)
	{ // IE
		return "block";
	}
	else if (window.XMLHttpRequest)
	{ // Mozilla, Safari,...
		return "table-row";
	}
}
function butwork(zhi1,zhi2,zhi3,zhi4)
{
	if(zhi1 == "false")
	{
		document.getElementById("bBACK").style.visibility = "visible";
		document.getElementById("bBACK").style.display = style_display_on();
	}
	else
	{
		document.getElementById("bBACK").style.visibility = "hidden";
		document.getElementById("bBACK").style.display = "none";
	}
	
	if(zhi2 == "false")
	{
		document.getElementById("bNEXT").style.visibility = "visible";
		document.getElementById("bNEXT").style.display = style_display_on();
	}
	else
	{
		document.getElementById("bNEXT").style.visibility = "hidden";
		document.getElementById("bNEXT").style.display = "none";
	}

		if(zhi3 == "false")
	{
		document.getElementById("bCANCEL").style.visibility = "visible";
		document.getElementById("bCANCEL").style.display = style_display_on();
	}
	else
	{
		document.getElementById("bCANCEL").style.visibility = "hidden";
		document.getElementById("bCANCEL").style.display = "none";
	}

		if(zhi4 == "false")
	{
		document.getElementById("bAPPLY").style.visibility = "visible";
		document.getElementById("bAPPLY").style.display = style_display_on();
	}
	else
	{
		document.getElementById("bAPPLY").style.visibility = "hidden";
		document.getElementById("bAPPLY").style.display = "none";
	}

}
function checkInjection(str)
{
	var len = str.length;
	for (var i=0; i<str.length; i++) {
		if ( str.charAt(i) == '\r' || str.charAt(i) == '\n'){
				return false;
		}else
	        continue;
	}
    return true;
}

function reloadd()
{
	window.location.reload();
}

function disableWirelessSettings()
{
	document.wizard_form.AP_SSID.disabled = false;
	switch_security_mode();
}


function switch_security_mode()
{
	document.getElementById("div_security_key").style.visibility = "visible";
	document.getElementById("div_security_key").style.display = style_display_on();
	document.wizard_form.PSK_KEY.disabled = false;
	if (document.wizard_form.AP_SECMODE.selectedIndex != 0)
	{
		document.getElementById("div_security_key").style.visibility = "hidden";
		document.getElementById("div_security_key").style.display = "none";
		document.wizard_form.PSK_KEY.disabled = true;
	}
}

function CheckWirelessValue()
{
	if(document.wizard_form.WIFION_OFF[0].checked == true)
	{
		if (document.wizard_form.AP_SSID.value.length == 0)
		{
			alert(_("err SSID empty"));
			document.wizard_form.AP_SSID.select();
			return false;
		}
		if (document.wizard_form.AP_SSID.value.length > 24 )
		{
			alert(_("err SSID length"));
			document.wizard_form.AP_SSID.select();
			return false;
		}
		
		if (document.wizard_form.AP_SECMODE.selectedIndex == 0)
		{
			var keyvalue = document.wizard_form.PSK_KEY.value;
			if (keyvalue.length == 0)
			{
				alert(_("err key"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}
			if ((keyvalue.length < 6)||( keyvalue.length > 12))
			{
				alert(_("err keylen"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}

			/*
			if(checkInjection(keyvalue) == false)
			{
				alert(_("err keychar"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}			*/
			{
				var xxx=keyvalue;  //用户名（在此赋值）

				var reg  = /^[a-z || A-Z || 0-9]\w+$/;
				var m = reg.test(xxx);
				if(m)   
				{   
				}   
				else   
				{   
					alert(_("err keychar"));
					document.wizard_form.PSK_KEY.select();
					return false;
				} 

			}
		}	
	}
	waitgifshow();
	document.getElementById('WIRELESS').click();
	return true;
}
function initTranslation()
{
	var e = document.getElementById("qsettitle");
	e.innerHTML = _("admw w3ttitle");
	e = document.getElementById("wifides");
	e.innerHTML = _("admw wifides");
	
	e = document.getElementById("wsetingst");
	e.innerHTML = _("admw wsetingst");
	e = document.getElementById("nname");
	e.innerHTML = _("admw nname");
	e = document.getElementById("security");
	e.innerHTML = _("admw security");
	e = document.getElementById("wkey");
	e.innerHTML = _("admw wkey");
	
	e = document.getElementById("Sdisable");
	e.innerHTML = _("admin open");
	e = document.getElementById("Senable");
	e.innerHTML = _("admin jiami");
	
	e = document.getElementById("showp");
	e.innerHTML = _("admw showp");	
	e = document.getElementById("bCANCEL");
	e.value = _("admw bCANCEL");
	e = document.getElementById("bAPPLY");
	e.value = _("admw bAPPLY");
	
	e = document.getElementById("onbutton");
	e.innerHTML = _("admw onbutton");	
	e = document.getElementById("offbutton");
	e.innerHTML = _("admw offbutton");
	
	e = document.getElementById("ssidrequest");
	e.innerHTML = _("admw ssidrequest");
	e = document.getElementById("passwordrequest");
	e.innerHTML = _("admw passwordrequest");

	e = document.getElementById("wifiswitch");
	e.innerHTML = _("admw wifiswitch");	 
	
	e = document.getElementById("settingwaiting");
	e.innerHTML = _("admw settingwaiting");	

	
	e = document.getElementById("channelchoose");
	e.innerHTML = _("admw channelchoose");	
	e = document.getElementById("channelauto");
	e.innerHTML = _("admw channelauto");	

}
function initValue()
{
	Butterlate.setTextDomain("admin");
	initTranslation();
	disableWirelessSettings();
	switch_wifi();
}
function showpwd()
{
 
 if(document.getElementById("pwd").type=="password"){
   var pass = document.getElementById("pwd").value;
   document.getElementById("pwdinput").innerHTML='<input type="text" id="pwd" name="PSK_KEY" maxlength="64" size="28" class="handaer_text_content"  value="'+pass+'" />';
  }else{
   var pass = document.getElementById("pwd").value;
   document.getElementById("pwdinput").innerHTML='<input type="password" id="pwd" name="PSK_KEY" maxlength="64" size="28"  class="handaer_text_content" value="'+pass+'" />';
   }
 }
 
function switch_wifi()
{
	if(document.wizard_form.WIFION_OFF[0].checked == true)
	{
		document.getElementById("div_security_key").style.visibility = "visible";
		document.getElementById("div_security_key").style.display = style_display_on();
		document.getElementById("tt1").style.visibility = "visible";
		document.getElementById("tt1").style.display = style_display_on();
		document.getElementById("channel").style.visibility = "visible";
		document.getElementById("channel").style.display = style_display_on();
		
		switch_security_mode();
	}
	else
	{
		document.getElementById("div_security_key").style.visibility = "hidden";
		document.getElementById("div_security_key").style.display = "none";
		document.getElementById("tt1").style.visibility = "hidden";
		document.getElementById("tt1").style.display = "none";
		document.getElementById("channel").style.visibility = "hidden";
		document.getElementById("channel").style.display = "none";
	}
}
function waitgifshow()
{
	document.getElementById("div_wireless").style.visibility = "hidden";
	document.getElementById("div_wireless").style.display = "none";
	
	document.getElementById("waitshow").style.visibility = "visible";
	document.getElementById("waitshow").style.display = style_display_on();
	document.getElementById("buttontable").style.visibility = "hidden";
	document.getElementById("buttontable").style.display = "none";
}
</script>
<LINK REL="stylesheet" HREF="/style/handaer.css" TYPE="text/css" media="all">
</head>

<body onLoad="initValue()" ondragstart="window.event.returnValue=false" oncontextmenu="window.event.returnValue=false" onselectstart="event.returnValue=false">
<div class="handaer_main">
<table  width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<h1 id="qsettitle"></h1>
<p></p>

<FORM method="POST" name="wizard_form">
<!-- =========== Wireless Settings =========== -->
<h2 id="wifides"></h2>
<table id="div_wireless"  width="100%" cellpadding="0" cellspacing="0"   class="handaer_text">
<tr><td class="title" colspan="2" id="wsetingst"></td></tr>
<tr>
  <td class="head" id="nname"></td>
  <td><input type="text" name="AP_SSID" size="32" maxlength="32" class="handaer_text_content"  value="~~AP_SSID~">&nbsp;<span id="ssidrequest"></span></td>
</tr>

<tr>
 <td class="head" id="wifiswitch"></td>
	<td><input type="radio"  ~cWIFION_OFF:on~ name="WIFION_OFF" value="on" onclick="switch_wifi();" checked /><span id="onbutton"></span>
	<input type="radio"  ~cWIFION_OFF:off~ name="WIFION_OFF" value="off" onclick="switch_wifi();"/><span id="offbutton"></span>
	</td>
</tr>

<tr id="channel">
  <td class="head" id="channelchoose"></td>
  <td>
    <select name="AP_CHANNEL" size="1">
	  <option ~sAP_CHANNEL:0~ value="0" id="channelauto"></option>
	  <option ~sAP_CHANNEL:1~ value="1">1</option>
      <option ~sAP_CHANNEL:2~ value="2">2</option>
      <option ~sAP_CHANNEL:3~ value="3">3</option>
      <option ~sAP_CHANNEL:4~ value="4">4</option>
      <option ~sAP_CHANNEL:5~ value="5">5</option>
      <option ~sAP_CHANNEL:6~ value="6">6</option>
      <option ~sAP_CHANNEL:7~ value="7">7</option>
      <option ~sAP_CHANNEL:8~ value="8">8</option>
      <option ~sAP_CHANNEL:9~ value="9">9</option>
      <option ~sAP_CHANNEL:10~ value="10">10</option>
      <option ~sAP_CHANNEL:11~ value="11">11</option>
      <option ~sAP_CHANNEL:12~ value="12">12</option>
      <option ~sAP_CHANNEL:13~ value="13">13</option>
      <option ~sAP_CHANNEL:14~ value="14">14</option>
      <option ~sAP_CHANNEL:15~ value="15">15</option>
      <option ~sAP_CHANNEL:16~ value="16">16</option>

    </select>
  </td>
</tr>

<tr  id="tt1">
  <td class="head" rowspan="2" id="security"></td>
  <td>
    <select name="AP_SECMODE" size="1" onChange="switch_security_mode();">
	  <option ~sAP_SECMODE:WPA~ value="WPA" id="Senable" ></option>
      <option ~sAP_SECMODE:None~  value="None" id="Sdisable"></option>
      <!--option value="WEPAUTO">WEP</option>
      <option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK</option-->
    </select>
  </td>
</tr>
<tr id="div_security_key">
  <td><span id="wkey"></span><span id="pwdinput"><input type="password" id="pwd" name="PSK_KEY" maxlength="64" size="28"  class="handaer_text_content"  value="~~PSK_KEY~"/></span><input type="checkbox" onClick="showpwd()" /><span id="showp"></span>&nbsp;<span id="passwordrequest"></span></td>
							
</tr>
</table>
<div id="waitshow" style="display:none" align="center">
  <img align="center" src="/images/loading.gif"></img>
  <p align="center" id="settingwaiting"></p>
</div>

<table width="540" cellpadding="2" cellspacing="1" id="buttontable">
<tr align="center">
  <td>
    <input type="button" name="cancel_motion" id="bCANCEL" class="handaer_input" value="Cancel" onClick="reloadd();">
    <input type="button" name="apply_motion" id="bAPPLY" class="handaer_input" value="Apply" onClick="CheckWirelessValue();">
	<input type="submit" name="WIRELESS" id="WIRELESS" style="display:none" value="WIRELESS">

  </td>
</tr>
</table>
<!--/form-->

</td></tr></table> </div>
</body>

</html>

