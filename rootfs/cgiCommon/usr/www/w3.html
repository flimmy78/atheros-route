<html>
<head>
<title>Wizard Internet Settings</title>
<LINK REL="stylesheet" HREF="/style/handaer.css" TYPE="text/css" media="all">
<link rel="stylesheet" href="/style/normal_ws.css" type="text/css">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<script language="JavaScript" type="text/javascript" src="/lang/b28n.js"></script>
<script language="JavaScript" type="text/javascript">
function button_commit(buttonID){document.getElementById(buttonID).click();}
var step_num;
function style_display_on()
{
	if (window.ActiveXObject)
	{ // IE
		return "block";
	}
	else if (window.XMLHttpRequest)
	{ // Mozilla, Safari,...
		return "table-row";
	}
}

function checkInjection(str)
{
	var len = str.length;
	for (var i=0; i<str.length; i++) {
		if ( str.charAt(i) == '\r' || str.charAt(i) == '\n'){
				return false;
		}else
	        continue;
	}
    return true;
}

function reloadd()
{
	window.location.reload();
}

function disableWirelessSettings()
{
	document.wizard_form.AP_SSID.disabled = false;
	switch_security_mode();
}


function switch_security_mode()
{
	document.getElementById("div_security_key").style.visibility = "visible";
	document.getElementById("div_security_key").style.display = style_display_on();
	document.wizard_form.PSK_KEY.disabled = false;
	if (document.wizard_form.AP_SECMODE.selectedIndex != 0)
	{
		document.getElementById("div_security_key").style.visibility = "hidden";
		document.getElementById("div_security_key").style.display = "none";
		document.wizard_form.PSK_KEY.disabled = true;
	}
}

function CheckWirelessValue()
{
	if(document.wizard_form.WIFION_OFF[0].checked == true)
	{
		if (document.wizard_form.AP_SSID.value.length == 0)
		{
			alert(_("err SSID empty"));
			document.wizard_form.AP_SSID.select();
			return false;
		}
		if (document.wizard_form.AP_SSID.value.length > 24 )
		{
			alert(_("err SSID length"));
			document.wizard_form.AP_SSID.select();
			return false;
		}
		
		if (document.wizard_form.AP_SECMODE.selectedIndex == 0)
		{
			var keyvalue = document.wizard_form.PSK_KEY.value;
			if (keyvalue.length == 0)
			{
				alert(_("err key"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}
			if ((keyvalue.length < 8)||( keyvalue.length > 12))
			{
				alert(_("err keylen"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}

			/*
			if(checkInjection(keyvalue) == false)
			{
				alert(_("err keychar"));
				document.wizard_form.PSK_KEY.select();
				return false;
			}			*/
			{
				var xxx=keyvalue;  //用户名（在此赋值）

				var reg  = /^[a-z || A-Z || 0-9]\w+$/;
				var m = reg.test(xxx);
				if(m)   
				{   
				}   
				else   
				{   
					alert(_("err keychar"));
					document.wizard_form.PSK_KEY.select();
					return false;
				} 

			}
		}	
	}
	else
	{
		document.wizard_form.AP_PRIMARY_CH.disabled = true;
		document.wizard_form.AP_SECMODE.disabled = true;
		document.getElementById("pwd").disabled = true;	   
	}
	waitgifshow();
	button_commit('WIRELESS');
	return true;
}
function initTranslation()
{
	var e = document.getElementById("qsettitle");
	e.innerHTML = _("admw w3ttitle");
	e = document.getElementById("wifides");
	e.innerHTML = _("admw wifides");
	
	e = document.getElementById("wsetingst");
	e.innerHTML = _("admw wsetingst");
	e = document.getElementById("nname");
	e.innerHTML = _("admw nname");
	e = document.getElementById("security");
	e.innerHTML = _("admw security");
	e = document.getElementById("wkey");
	e.innerHTML = _("admw wkey");
	
	e = document.getElementById("Sdisable");
	e.innerHTML = _("admin open");
	e = document.getElementById("Senable");
	e.innerHTML = _("admin jiami");
	
	e = document.getElementById("showp");
	e.innerHTML = _("admw showp");	
	e = document.getElementById("bCANCEL");
	e.value = _("admw bCANCEL");
	e = document.getElementById("bAPPLY");
	e.value = _("admw bAPPLY");
	
	e = document.getElementById("onbutton");
	e.innerHTML = _("admw onbutton");	
	e = document.getElementById("offbutton");
	e.innerHTML = _("admw offbutton");
	
	e = document.getElementById("ssidrequest");
	e.innerHTML = _("admw ssidrequest");
	e = document.getElementById("passwordrequest");
	e.innerHTML = _("admw passwordrequest");

	e = document.getElementById("wifiswitch");
	e.innerHTML = _("admw wifiswitch");	 
	
	e = document.getElementById("channelchoose");
	e.innerHTML = _("admw channelchoose");	
	e = document.getElementById("hidewifides");
	e.innerHTML = _("admw hidewifides");	
}
function initValue()
{
	Butterlate.setTextDomain("admin");
	initTranslation();
	disableWirelessSettings();
	switch_wifi();
	inithidewifi();
	var ifwdson = document.getElementById("WDSON").value;
	if(ifwdson=="on")
	{
		document.getElementById("AP_PRIMARY_CH").disabled = true;
	}
}
function showpwd()
{
	var pass = document.getElementById("pwd").value;
	if(document.getElementById("cccc").checked == true)
	{
        document.getElementById("pwdinput").innerHTML='<input type="text" id="pwd" name="PSK_KEY" maxlength="64" size="28" class="handaer_text_content"  value="'+pass+'" />';
	}
	else
	{
		document.getElementById("pwdinput").innerHTML='<input type="password" id="pwd" name="PSK_KEY" maxlength="64" size="28"  class="handaer_text_content" value="'+pass+'" />';
	}
 }
 
 
function switch_wifi()
{
	if(document.wizard_form.WIFION_OFF[0].checked == true)
	{
		document.getElementById("div_security_key").style.visibility = "visible";
		document.getElementById("div_security_key").style.display = style_display_on();
		document.getElementById("tt1").style.visibility = "visible";
		document.getElementById("tt1").style.display = style_display_on();
		document.getElementById("channel").style.visibility = "visible";
		document.getElementById("channel").style.display = style_display_on();
		
		switch_security_mode();
	}
	else
	{
		document.getElementById("div_security_key").style.visibility = "hidden";
		document.getElementById("div_security_key").style.display = "none";
		document.getElementById("tt1").style.visibility = "hidden";
		document.getElementById("tt1").style.display = "none";
		document.getElementById("channel").style.visibility = "hidden";
		document.getElementById("channel").style.display = "none";
	}
}
function waitgifshow()
{
	window.parent.Demo(_("admw settingwaiting"));
}
function inithidewifi()
{
	if(document.getElementById("AP_HIDESSID").value=="1")
	{
		document.getElementById("hidewifi").checked = true;
	}
	else
	{
		document.getElementById("hidewifi").checked = false;
	}
	
}
function hidewififun()
{
	if(document.getElementById("hidewifi").checked == true)
		document.getElementById("AP_HIDESSID").value="1";
	else
		document.getElementById("AP_HIDESSID").value="0";
}
</script>
</head>

<body onLoad="initValue()" ondragstart="window.event.returnValue=false" oncontextmenu="window.event.returnValue=false" onselectstart="event.returnValue=false">
<div class="handaer_main">
<table  width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<h1 id="qsettitle"></h1>
<p></p>

<FORM method="POST" name="wizard_form">
<!-- =========== Wireless Settings =========== -->
<h2 id="wifides"></h2>
<table id="div_wireless"  width="100%" cellpadding="0" cellspacing="0"   class="handaer_text">
<tr><td class="title" colspan="2" id="wsetingst"></td></tr>
<tr>
  <td class="head" id="nname"></td>
  <td><input type="text" name="AP_SSID" size="32" maxlength="32" class="handaer_text_content"  value="~~AP_SSID~">&nbsp;<input type="checkbox" id="hidewifi" onclick="hidewififun();"/>&nbsp;<label for="hidewifi" id="hidewifides"></label>&nbsp;<span id="ssidrequest"></span></td>
</tr>

<tr>
 <td class="head" id="wifiswitch"></td>
	<td><input type="radio"  ~cWIFION_OFF:on~ id="rad_1" name="WIFION_OFF" value="on" onclick="switch_wifi();" checked /><label for="rad_1"  id="onbutton"></label>
	<input type="radio"  ~cWIFION_OFF:off~ id="rad_2" name="WIFION_OFF" value="off" onclick="switch_wifi();"/><label for="rad_2"  id="offbutton"></label>
	</td>
</tr>

<tr id="channel">
  <td class="head" id="channelchoose"></td>
  <td>
    <select name="AP_PRIMARY_CH" id="AP_PRIMARY_CH" size="1">
	  <!--option ~sAP_PRIMARY_CH:0~ value="0" id="channelauto"></option-->
	  <option ~sAP_PRIMARY_CH:1~ value="1">1</option>
      <option ~sAP_PRIMARY_CH:2~ value="2">2</option>
      <option ~sAP_PRIMARY_CH:3~ value="3">3</option>
      <option ~sAP_PRIMARY_CH:4~ value="4">4</option>
      <option ~sAP_PRIMARY_CH:5~ value="5">5</option>
      <option ~sAP_PRIMARY_CH:6~ value="6">6</option>
      <option ~sAP_PRIMARY_CH:7~ value="7">7</option>
      <option ~sAP_PRIMARY_CH:8~ value="8">8</option>
      <option ~sAP_PRIMARY_CH:9~ value="9">9</option>
      <option ~sAP_PRIMARY_CH:10~ value="10">10</option>
      <option ~sAP_PRIMARY_CH:11~ value="11">11</option>
      <option ~sAP_PRIMARY_CH:12~ value="12">12</option>
      <option ~sAP_PRIMARY_CH:13~ value="13">13</option>
    </select>
  </td>
</tr>

<tr id="tt1">
  <td class="head" id="security"></td>
  <td>
    <select name="AP_SECMODE" style="width:150px" size="1" onChange="switch_security_mode();">
	  <option ~sAP_SECMODE:WPA~ value="WPA" id="Senable"></option>
      <option ~sAP_SECMODE:None~  value="None" id="Sdisable"></option>
    </select>
  </td>
</tr>
<tr id="div_security_key">
<td class="head" id="wkey"></td>
  <td><span id="pwdinput"><input type="password" id="pwd" name="PSK_KEY" maxlength="64" size="28"  class="handaer_text_content"  value="~~PSK_KEY~"/></span>&nbsp;<input type="checkbox" id="cccc" onClick="showpwd()" />&nbsp;<label for="cccc" id="showp"></label>&nbsp;<span id="passwordrequest"></span></td>
</tr>
</table>

<table width="540" cellpadding="2" cellspacing="1" id="buttontable">
<tr align="center">
  <td>
    <input type="button" name="cancel_motion" id="bCANCEL" class="handaer_input" value="Cancel" onClick="reloadd();">
    <input type="button" name="apply_motion" id="bAPPLY" class="handaer_input" value="Apply" onClick="CheckWirelessValue();">
	<input type="submit" name="WIRELESS" id="WIRELESS" style="display:none" value="WIRELESS">
	<input type="text" style="display:none" name="AP_HIDESSID" id="AP_HIDESSID" size="20" maxlength="32" value="~~AP_HIDESSID~">
	<input type="text" style="display:none" name="WDSON" id="WDSON" size="20" maxlength="32" value="~~WDSON_OFF~">
  </td>
</tr>
</table>
<!--/form-->

</td></tr></table> </div>
</body>

</html>

