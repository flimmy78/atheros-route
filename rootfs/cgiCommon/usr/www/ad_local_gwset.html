<html>
<head>
<title>DHCP</title>
<link rel="stylesheet" href="/style/normal_ws.css" type="text/css">
<LINK REL="stylesheet" HREF="/style/handaer.css" TYPE="text/css" media="all">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<script language="JavaScript" type="text/javascript" src="/lang/b28n.js"></script>
<script language="JavaScript" type="text/javascript">
var step_num;
function style_display_on(){if (window.ActiveXObject){return "inline-block";}else if (window.XMLHttpRequest){return "table-row";}}
function widget_hide(widgetID){document.getElementById(widgetID).style.visibility = "hidden";document.getElementById(widgetID).style.display = "none";}
function widget_display(widgetID){document.getElementById(widgetID).style.visibility = "visible";document.getElementById(widgetID).style.display = style_display_on();}

function widget_enable(widgetID){document.getElementById(widgetID).disabled = false;}
function widget_disable(widgetID){document.getElementById(widgetID).disabled = true;}

function trans_inner(widgetID,xmlname){var e = document.getElementById(widgetID);e.innerHTML = _(xmlname);}
function trans_value(widgetID,xmlname){var e = document.getElementById(widgetID);e.value = _(xmlname);}

function button_commit(buttonID){document.getElementById(buttonID).click();}

function atoi(str, num)
{
	i = 1;
	if (num != 1) {
		while (i != num && str.length != 0) {
			if (str.charAt(0) == '.') {
				i++;
			}
			str = str.substring(1);
		}
		if (i != num)
			return -1;
	}

	for (i=0; i<str.length; i++) {
		if (str.charAt(i) == '.') {
			str = str.substring(0, i);
			break;
		}
	}
	if (str.length == 0)
		return -1;
	return parseInt(str, 10);
}

function checkRange(str, num, min, max)
{
	d = atoi(str, num);
	if (d > max || d < min)
		return false;
	return true;
}

function isAllNum(str)
{
	for (var i=0; i<str.length; i++) {
		if ((str.charAt(i) >= '0' && str.charAt(i) <= '9') || (str.charAt(i) == '.' ))
			continue;
		return 0;
	}
	return 1;
}

function checkIpAddr(field, ismask)
{
	if (field.value == "") 
	{
		if(ismask)
		{
			alert(_("err sub empty"));
		}
		else
		{	
			alert(_("err IP empty"));
		}
		field.value = field.defaultValue;
		field.focus();
		return false;
	}

	if (isAllNum(field.value) == 0) 
	{
		alert(_("err format"));
		field.value = field.defaultValue;
		field.focus();
		return false;
	}

	if (ismask)
	{
		if ((!checkRange(field.value, 1, 0, 256)) ||
				(!checkRange(field.value, 2, 0, 256)) ||
				(!checkRange(field.value, 3, 0, 256)) ||
				(!checkRange(field.value, 4, 0, 256)))
		{
			alert(_("err sub format"));
			field.value = field.defaultValue;
			field.focus();
			return false;
		}
	}
	else 
	{
		if ((!checkRange(field.value, 1, 0, 255)) ||
				(!checkRange(field.value, 2, 0, 255)) ||
				(!checkRange(field.value, 3, 0, 255)) ||
				(!checkRange(field.value, 4, 1, 254)))
		{
			alert(_("err IP format"));
			field.value = field.defaultValue;
			field.focus();
			return false;
		}
	}
	{
		var exp=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;
		var reg = field.value.match(exp);
		if(reg==null)
		{
			if(ismask)
			{
				alert(_("err sub format"));
			}
			else
			{	
				alert(_("err IP format"));
			}
			field.value = field.defaultValue;
			field.focus();
			return false;
		}
	}

	return true;
}
function CheckValue()
{
	
	//if (document.WORKFORM.GW_MAC.value.length == 0)
	//{
	//	alert(_("err MAC empty"));
	//	document.WORKFORM.GW_MAC.select();
	//	return false;
	//}
	//var re = /[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}/;
	//if (!re.test(document.WORKFORM.GW_MAC.value))
	//{
	//	alert(_("err MAC format"));
	//	document.WORKFORM.GW_MAC.select();
	//	return false;
	//}
	if (!checkIpAddr(document.WORKFORM.GW_IP, false))
	{
		document.WORKFORM.GW_IP.select();
		return false;
	}
	if (!checkIpAddr(document.WORKFORM.GW_SUB, true))
	{
		document.WORKFORM.GW_SUB.select();
		return false;
	}
	
	button_commit("GW_SET");
	return true;
}

function initTranslation()
{
	trans_value("bCANCEL","lan bCANCEL");
	trans_value("bAPPLY","lan bAPPLY");
	
	trans_inner("title","gw title");	
	trans_inner("des","gw des");	
	trans_inner("t1_title","gw t1_title");	
	trans_inner("t1_MAC","gw t1_MAC");	
	trans_inner("t1_IP","gw t1_IP");	
	trans_inner("t1_SUB","gw t1_SUB");	
}

function initValue()
{
	Butterlate.setTextDomain("lan");
	initTranslation();
	widget_disable("GW_MAC");
}

</script>
</head>

<body onLoad="initValue()">
<div class="handaer_main">
<table  width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<h1 id="title">网关设置</h1>
<p></p>

<FORM method="POST" name="WORKFORM">
<!-- =========== Wireless Settings =========== -->
<h2 id="des">配置网关选项</h2>

<table id="t1"  width="100%" cellpadding="0" cellspacing="0"  class="handaer_text">
<tr>
<td class="title" colspan="2" id="t1_title">网关设置</td>
</tr>
<tr>
  <td class="head" id="t1_MAC">MAC地址</td>
  <td><input type="text" name="GW_MAC" id="GW_MAC" size="32" maxlength="32" class="handaer_text_content"  value="~~BR0_MAC~"></td>
</tr>
<tr>
  <td class="head" id="t1_IP">IP地址</td>
  <td><input type="text" name="GW_IP" id="GW_IP" size="32" maxlength="32" class="handaer_text_content"  value="~~AP_IPADDR~"></td>
</tr>
<tr>
  <td class="head" id="t1_SUB">子网掩码</td>
  <td><input type="text" name="GW_SUB" id="GW_SUB" size="32" maxlength="32" class="handaer_text_content"  value="~~AP_NETMASK~"></td>
</tr>
</table>

<table id="buttontable">
<tr align="center">
  <td>
    <input type="button" name="cancel_motion" id="bCANCEL" class="handaer_input" value="Cancel" onClick="window.location.reload();">
    <input type="button" name="apply_motion" id="bAPPLY" class="handaer_input" value="Apply" onClick="CheckValue();">
	<input type="submit" name="GW_SET" id="GW_SET" style="display:none" value="GW_SET">
  </td>
</tr>
</table>

</form>
</td></tr></table> 
</div>
</body>
</html>

