<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<LINK REL="stylesheet" HREF="/style/handaer.css" TYPE="text/css" media="all">
<link rel="stylesheet" href="/style/normal_ws.css" type="text/css">
<script type="text/javascript" src="/lang/b28n.js"></script>
<script>

function trans_inner(widgetID,xmlname){var e = document.getElementById(widgetID);e.innerHTML = _(xmlname);}
function trans_value(widgetID,xmlname){var e = document.getElementById(widgetID);e.value = _(xmlname);}
function button_commit(buttonID){document.getElementById(buttonID).click();}
function initTranslation()
{
	trans_inner("title","macc title");
	trans_inner("des","macc des");
	trans_inner("t1_title","macc t1_title");
	trans_inner("t1_mac","macc t1_mac");
	trans_inner("t1_PCmac","macc t1_PCmac");
	trans_value("macback_b","macc macback_b");
	trans_value("macclone_b","macc macclone_b");
	
	trans_value("wApply","inet apply");
	trans_value("wCancel","inet cancel");
	
	 
}
function init()
{
	Butterlate.setTextDomain("wan");
	initTranslation();
	getMac();
}
function chackMAC()
{
	var re = /[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}/;
	if (document.WORKFORM.MAC.value.length == 0)
	{
		alert(_("err MAC empty"));
		document.WORKFORM.MAC.focus();
		return false;
	}
	if (!re.test(document.WORKFORM.MAC.value))
	{
		alert(_("err MAC format"));
		document.WORKFORM.PCMAC.focus();
		return false;
	}
	button_commit("MAC_CLONE");
}

function macclone_f()
{
	if(document.getElementById("PCMAC").value!="")
	{
		document.getElementById("MAC").value = document.getElementById("PCMAC").value;
	}
}

function getMac()
{       
	var locator =new ActiveXObject ("WbemScripting.SWbemLocator");
	var service = locator.ConnectServer(".");
	var properties = service.ExecQuery("Select * from Win32_NetworkAdapterConfiguration Where IPEnabled =True");
	var e =new Enumerator (properties);
	{
		var p = e.item();
		var mac = p.MACAddress;
		document.getElementById("PCMAC").value=mac;
	}
 } 
function reloadMAC()
{       
	button_commit("MAC_BACK");
} 
 
</script>

</head>

<body onload="init()">
<div class="handaer_main">
<table  border="0" cellpadding="0" cellspacing="0" id="tt2"><tr><td>

<h1 id="title">MAC地址克隆</h1>
<p></p>

<FORM method="POST" name="WORKFORM">
<!-- =========== Wireless Settings =========== -->
<h2 id="des">设置BASE对广域网的MAC地址（  注意：只有局域网中计算机可以使用本功能）</h2>
<table id="MAC_clone_t"  width="100%" cellpadding="0" cellspacing="0"   class="handaer_text">
<tr>
<td class="title" colspan="3" id="t1_title">MAC地址克隆</td></tr>
<tr>
  <td class="head" id="t1_mac">MAC地址</td>
  <td width="30%" ><input size="32" maxlength="64" class="handaer_text_content" name="MAC" id="MAC" value="" type="text"></td>
  <td width="20%" ><input type="button" class="handaer_small_button"  name="macback_b" id="macback_b" onClick="reloadMAC()"></td>
  <input type="submit" name="MAC_BACK" id="MAC_BACK" style="display:none" value="MAC_BACK">
</tr>
<tr>
  <td class="head" id="t1_PCmac">当前管理者PC的MAC地址</td>
  <td><input size="32" maxlength="64" name="PCMAC" class="handaer_text_content"   id="PCMAC" value="" type="text" readonly></td>
  <td><input type="button" name="macclone_b" id="macclone_b" class="handaer_small_button" onClick="macclone_f();"></td>
</tr>

</table>
<table width="100%" cellpadding="2" cellspacing="1">
<tr align="center">
  <td>
    <input type="reset"  class="handaer_input" value="Cancel" id="wCancel" onClick="window.location.reload()">    
	<input type="button" class="handaer_input" value="Apply" id="wApply" onClick="chackMAC()">&nbsp;&nbsp;
    <input type="submit" name="MAC_CLONE" id="MAC_CLONE" style="display:none" value="MAC_CLONE">	
  </td>
</tr>
</table>
</FORM>
</td></tr>
</table>
</div>

</body>
</html>
