#!/bin/sh
BAIDU=www.baidu.com
GOOGLE=8.8.8.8

while true
do
#VAL="`ethreg -p 4 0x11 | awk -F' ' '/Read Reg/{print $5}'`"
VAL="`ethreg -p 4 0x11 | grep "Read Reg" | sed 's/.* //g' `"
VAL2=0x0400
#echo $VAL
VAL=$(($VAL&0x0400))
#echo $VAL

if [ $VAL -eq 1024 ];then
#	ping -c 3 $BAIDU  > /tmp/ping.log
	ping -c 3 $BAIDU  > /tmp/ping.log &
	sleep 3
	mes=`grep icmp_seq /tmp/ping.log`

	if [ -z "${mes}" ];then
	        echo "0">/usr/www/ping.xml
	else
	        echo "1">/usr/www/ping.xml
	fi
	rm -fr /tmp/ping.log
else
if [ $VAL -eq 0 ];then
	echo "0">/usr/www/ping.xml
fi
fi
#cfg -c
#sleep 3
done
